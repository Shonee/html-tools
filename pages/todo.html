<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>WPSæ–‡ä»¶æŠ¥é€ç®¡ç†ç³»ç»Ÿ</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
}

body {
    background: linear-gradient(135deg, #e3f2fd 0%, #c8e6c9 100%);
    color: #2c3e50;
    min-height: 100vh;
    padding: 20px;
    display: flex;
    justify-content: center;
}

.container {
    width: 100%;
    max-width: 1400px;
    background: white;
    border-radius: 15px;
    box-shadow: 0 15px 50px rgba(0, 0, 0, 0.15);
    overflow: hidden;
    display: flex;
    flex-direction: column;
}

header {
    background: linear-gradient(135deg, #1a73e8 0%, #0d47a1 100%);
    color: white;
    padding: 25px 40px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    position: relative;
    overflow: hidden;
}

header::before {
    content: "";
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
    transform: rotate(30deg);
}

.logo {
    display: flex;
    align-items: center;
    gap: 15px;
}

.logo-icon {
    font-size: 2.8rem;
}

.title h1 {
    font-size: 2.2rem;
    margin-bottom: 5px;
}

.title p {
    opacity: 0.9;
    font-size: 1.1rem;
}

.wps-badge {
    background: rgba(255, 255, 255, 0.2);
    padding: 10px 20px;
    border-radius: 25px;
    font-size: 1.1rem;
    display: flex;
    align-items: center;
    gap: 10px;
}

.main-content {
    display: flex;
    min-height: 700px;
}

.calendar-section {
    width: 50%;
    background: #f8f9fa;
    padding: 25px;
    border-right: 1px solid #e0e0e0;
    display: flex;
    flex-direction: column;
}

.calendar-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 25px;
    padding-bottom: 15px;
    border-bottom: 2px solid #e0e0e0;
}

.calendar-title {
    font-size: 1.8rem;
    font-weight: 600;
    color: #1a73e8;
}

.calendar-nav button {
    background: #1a73e8;
    color: white;
    border: none;
    padding: 10px 18px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 1rem;
    transition: all 0.3s;
    display: inline-flex;
    align-items: center;
    gap: 8px;
    z-index: 10;
}

.calendar-nav button:hover {
    background: #0d47a1;
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(13, 71, 161, 0.2);
}

.calendar-grid {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 10px;
    flex: 1;
}

.calendar-day-header {
    text-align: center;
    padding: 15px 0;
    background: #e3f2fd;
    font-weight: 600;
    color: #1a73e8;
    border-radius: 8px;
}

.calendar-day {
    height: 120px;
    background: white;
    border-radius: 8px;
    padding: 10px;
    overflow-y: auto;
    position: relative;
    transition: all 0.3s ease;
    cursor: pointer;
    border: 2px solid transparent;
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
    display: flex;
    flex-direction: column;
}

.calendar-day:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
    border-color: #1a73e8;
}

.day-number {
    font-weight: 600;
    color: #555;
    margin-bottom: 5px;
    padding-bottom: 5px;
    border-bottom: 1px solid #f0f0f0;
}

.today .day-number {
    background: #1a73e8;
    color: white;
    padding: 2px 8px;
    border-radius: 50%;
    display: inline-block;
    width: 28px;
    height: 28px;
    text-align: center;
    line-height: 24px;
}

.event {
    background: #1a73e8;
    color: white;
    padding: 6px 8px;
    border-radius: 4px;
    font-size: 0.85rem;
    margin-bottom: 5px;
    cursor: pointer;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.event.urgent {
    background: #e53935;
}

.event.warning {
    background: #ff9800;
}

.event.normal {
    background: #4caf50;
}

.calendar-events {
    margin-top: 15px;
    background: white;
    border-radius: 10px;
    padding: 20px;
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
    flex: 1;
}

.calendar-events h3 {
    color: #1a73e8;
    margin-bottom: 15px;
    padding-bottom: 10px;
    border-bottom: 2px solid #f0f0f0;
}

.event-list {
    max-height: 200px;
    overflow-y: auto;
}

.event-item {
    padding: 12px;
    border-bottom: 1px solid #eee;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.event-item:last-child {
    border-bottom: none;
}

.event-info {
    flex: 1;
}

.event-name {
    font-weight: 500;
    margin-bottom: 5px;
    color: #2c3e50;
}

.event-details {
    font-size: 0.9rem;
    color: #666;
    display: flex;
    gap: 15px;
}

.event-priority {
    display: inline-block;
    width: 12px;
    height: 12px;
    border-radius: 50%;
    margin-right: 5px;
}

.priority-urgent {
    background: #e53935;
}

.priority-warning {
    background: #ff9800;
}

.priority-normal {
    background: #4caf50;
}

.task-section {
    width: 50%;
    padding: 25px;
    display: flex;
    flex-direction: column;
}

.task-list-container {
    margin-bottom: 25px;
    background: #f8f9fa;
    border-radius: 10px;
    padding: 25px;
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
    display: flex;
    flex-direction: column;
    flex: 1;
}

.task-list-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
}

.task-list-header h2 {
    color: #1a73e8;
}

.btn-download {
    background: #ff9800;
    display: flex;
    align-items: center;
    gap: 8px;
}

.btn-download:hover {
    background: #f57c00;
}

.task-filters {
    display: flex;
    gap: 10px;
    margin-bottom: 15px;
}

.filter-btn {
    padding: 8px 16px;
    border-radius: 20px;
    cursor: pointer;
    font-size: 0.9rem;
    transition: all 0.3s;
    border: 1px solid #ddd;
    background: white;
}

.filter-btn.active {
    background: #1a73e8;
    color: white;
    border-color: #1a73e8;
}

.task-list {
    flex: 1;
    overflow-y: auto;
    border: 1px solid #e0e0e0;
    border-radius: 8px;
    background: white;
}

.task-item {
    padding: 15px;
    border-bottom: 1px solid #eee;
    display: flex;
    flex-direction: column;
    transition: all 0.3s ease;
}

.task-item:hover {
    background: #e3f2fd;
}

.task-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
}

.task-name {
    font-weight: 600;
    font-size: 1.1rem;
    color: #2c3e50;
}

.task-priority {
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 0.85rem;
    font-weight: 500;
}

.priority-high {
    background: #ffebee;
    color: #c62828;
}

.priority-medium {
    background: #fff8e1;
    color: #f57f17;
}

.priority-low {
    background: #e8f5e9;
    color: #2e7d32;
}

.task-details {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 15px;
    font-size: 0.95rem;
    color: #555;
}

.task-detail {
    display: flex;
    gap: 8px;
}

.task-detail i {
    color: #1a73e8;
    min-width: 20px;
}

.task-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 15px;
    padding-top: 10px;
    border-top: 1px dashed #eee;
}

.task-status {
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 0.9rem;
    font-weight: 500;
}

.status-pending {
    background: #fffde7;
    color: #f9a825;
}

.status-completed {
    background: #e8f5e9;
    color: #388e3c;
}

.task-actions {
    display: flex;
    gap: 10px;
}

.action-btn {
    padding: 6px 12px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 0.9rem;
    transition: all 0.3s;
}

.edit-btn {
    background: #e3f2fd;
    color: #1a73e8;
    border: 1px solid #bbdefb;
}

.edit-btn:hover {
    background: #bbdefb;
}

.delete-btn {
    background: #ffebee;
    color: #e53935;
    border: 1px solid #ffcdd2;
}

.delete-btn:hover {
    background: #ffcdd2;
}

.task-form {
    background: #f8f9fa;
    border-radius: 10px;
    padding: 25px;
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
}

.task-form h2 {
    color: #1a73e8;
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 2px solid #e0e0e0;
}

.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: block;
    margin-bottom: 8px;
    font-weight: 500;
    color: #555;
}

.form-control {
    width: 100%;
    padding: 12px 15px;
    border: 1px solid #ddd;
    border-radius: 8px;
    font-size: 1rem;
    transition: all 0.3s;
}

.form-control:focus {
    outline: none;
    border-color: #1a73e8;
    box-shadow: 0 0 0 3px rgba(26, 115, 232, 0.2);
}

.form-row {
    display: flex;
    gap: 15px;
}

.form-row .form-group {
    flex: 1;
}

.btn {
    display: inline-flex;
    align-items: center;
    gap: 10px;
    padding: 14px 25px;
    background: #1a73e8;
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 1.1rem;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s ease;
}

.btn:hover {
    background: #0d47a1;
    transform: translateY(-3px);
    box-shadow: 0 5px 15px rgba(13, 71, 161, 0.3);
}

.btn-add {
    background: #4caf50;
    width: 100%;
    justify-content: center;
    padding: 16px;
}

.btn-add:hover {
    background: #388e3c;
}

.stats-section {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 20px;
    padding: 25px;
    background: #f8f9fa;
    border-top: 1px solid #e0e0e0;
}

.stat-card {
    background: white;
    border-radius: 10px;
    padding: 25px;
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
    text-align: center;
    transition: all 0.3s ease;
    cursor: pointer;
}

.stat-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
}

.stat-icon {
    font-size: 2.5rem;
    color: #1a73e8;
    margin-bottom: 15px;
}

.stat-value {
    font-size: 2.5rem;
    font-weight: 700;
    color: #1a73e8;
    margin-bottom: 10px;
}

.stat-label {
    color: #666;
    font-size: 1.1rem;
}

footer {
    text-align: center;
    padding: 25px;
    color: #7f8c8d;
    font-size: 1rem;
    background: #f8f9fa;
    border-top: 1px solid #e0e0e0;
}

@media (max-width: 1200px) {
    .main-content {
        flex-direction: column;
    }

    .calendar-section, .task-section {
        width: 100%;
    }

    .calendar-section {
        border-right: none;
        border-bottom: 1px solid #e0e0e0;
    }

    .stats-section {
        grid-template-columns: 1fr;
    }
}

/* æ–°å¢ç¼–è¾‘æ¨¡æ€æ¡†æ ·å¼ */
.modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 100;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s, visibility 0.3s;
}

.modal.active {
    opacity: 1;
    visibility: visible;
}

.modal-content {
    background: white;
    border-radius: 15px;
    box-shadow: 0 15px 50px rgba(0, 0, 0, 0.2);
    width: 90%;
    max-width: 600px;
    transform: scale(0.8);
    transition: transform 0.3s;
}

.modal.active .modal-content {
    transform: scale(1);
}

.modal-header {
    padding: 20px;
    border-bottom: 1px solid #e0e0e0;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.modal-header h3 {
    color: #1a73e8;
    font-size: 1.5rem;
}

.close-modal {
    font-size: 1.5rem;
    cursor: pointer;
    color: #666;
    transition: color 0.3s;
}

.close-modal:hover {
    color: #2c3e50;
}

.modal-body {
    padding: 25px;
}

.modal-footer {
    padding: 20px;
    border-top: 1px solid #e0e0e0;
    display: flex;
    justify-content: flex-end;
    gap: 15px;
}

.btn-cancel {
    background: #e0e0e0;
    color: #2c3e50;
}

.btn-cancel:hover {
    background: #d0d0d0;
    transform: translateY(0);
    box-shadow: none;
}
</style>
</head>
<body>
<div class="container">
<header>
<div class="logo">
<div class="logo-icon">ğŸ“‹</div>
<div class="title">
<h1>æ–‡ä»¶æŠ¥é€ç®¡ç†ç³»ç»Ÿ</h1>
<p>é«˜æ•ˆç®¡ç†æŠ¥é€ä»»åŠ¡ï¼Œç¡®ä¿æŒ‰æ—¶å®Œæˆ</p>
</div>
</div>
<div class="wps-badge">
<i class="fas fa-check-circle"></i>
<span>linking</span>
</div>
</header>
<div class="main-content">
    <div class="calendar-section">
        <div class="calendar-header">
            <div class="calendar-title" id="current-month">2025å¹´6æœˆ</div>
            <div class="calendar-nav">
                <button id="prev-month"><i class="fas fa-chevron-left"></i> ä¸Šä¸ªæœˆ</button>
                <button id="today-btn">ä»Šå¤©</button>
                <button id="next-month">ä¸‹ä¸ªæœˆ <i class="fas fa-chevron-right"></i></button>
            </div>
        </div>

        <div class="calendar-grid" id="calendar">
            <!-- æ—¥å†å°†ç”±JavaScriptç”Ÿæˆ -->
        </div>

        <div class="calendar-events">
            <h3>ä»Šæ—¥æŠ¥é€ä»»åŠ¡</h3>
            <div class="event-list" id="today-events">
                <!-- ä»Šæ—¥ä»»åŠ¡å°†ç”±JavaScriptç”Ÿæˆ -->
            </div>
        </div>
    </div>

    <div class="task-section">
        <div class="task-list-container">
            <div class="task-list-header">
                <h2><i class="fas fa-tasks"></i> ä»£åŠåˆ—è¡¨</h2>
                <button class="btn btn-download" id="download-btn">
                    <i class="fas fa-download"></i> å¯¼å‡ºExcel
                </button>
            </div>

            <div class="task-filters">
                <button class="filter-btn active" data-filter="all">å…¨éƒ¨ä»»åŠ¡</button>
                <button class="filter-btn" data-filter="pending">å¾…æäº¤ä»»åŠ¡</button>
                <button class="filter-btn" data-filter="completed">å·²å®Œæˆä»»åŠ¡</button>
            </div>

            <div class="task-list" id="task-list">
                <!-- ä»»åŠ¡åˆ—è¡¨å°†ç”±JavaScriptç”Ÿæˆ -->
            </div>
        </div>

        <div class="task-form">
            <h2><i class="fas fa-plus-circle"></i> æ·»åŠ æŠ¥é€ä»»åŠ¡</h2>
            <form id="task-form">
                <div class="form-group">
                    <label for="task-name"><i class="fas fa-file-alt"></i> æ–‡ä»¶åç§°</label>
                    <input type="text" id="task-name" class="form-control" placeholder="ä¾‹å¦‚ï¼šæœˆåº¦è´¢åŠ¡æŠ¥å‘Š" required>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="sender"><i class="fas fa-paper-plane"></i> å‘æ–‡å•ä½</label>
                        <input type="text" id="sender" class="form-control" placeholder="å‘æ–‡éƒ¨é—¨" required>
                    </div>

                    <div class="form-group">
                        <label for="sender-date"><i class="fas fa-calendar-day"></i> å‘æ–‡æ—¥æœŸ</label>
                        <input type="date" id="sender-date" class="form-control" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="receiver"><i class="fas fa-inbox"></i> æ”¶æ–‡å•ä½</label>
                        <input type="text" id="receiver" class="form-control" placeholder="æ”¶æ–‡éƒ¨é—¨" required>
                    </div>

                    <div class="form-group">
                        <label for="due-date"><i class="fas fa-calendar-day"></i> æˆªæ­¢æ—¥æœŸ</label>
                        <input type="date" id="due-date" class="form-control" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="priority"><i class="fas fa-flag"></i> ä¼˜å…ˆçº§</label>
                        <select id="priority" class="form-control">
                            <option value="high">é«˜ï¼ˆç´§æ€¥ï¼‰</option>
                            <option value="medium" selected>ä¸­ï¼ˆé‡è¦ï¼‰</option>
                            <option value="low">ä½ï¼ˆæ™®é€šï¼‰</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="status"><i class="fas fa-tasks"></i> çŠ¶æ€</label>
                        <select id="status" class="form-control">
                            <option value="pending">å¾…æäº¤</option>
                            <option value="completed">å·²å®Œæˆ</option>
                        </select>
                    </div>
                </div>

                <button type="submit" class="btn btn-add">
                    <i class="fas fa-plus"></i> æ·»åŠ æŠ¥é€ä»»åŠ¡
                </button>
            </form>
        </div>
    </div>
</div>

<div class="stats-section">
    <div class="stat-card" data-filter="all">
        <div class="stat-icon"><i class="fas fa-tasks"></i></div>
        <div class="stat-value" id="total-tasks">0</div>
        <div class="stat-label">æ€»ä»»åŠ¡æ•°</div>
    </div>

    <div class="stat-card" data-filter="pending">
        <div class="stat-icon"><i class="fas fa-exclamation-triangle"></i></div>
        <div class="stat-value" id="pending-tasks">0</div>
        <div class="stat-label">å¾…æäº¤ä»»åŠ¡</div>
    </div>

    <div class="stat-card" data-filter="completed">
        <div class="stat-icon"><i class="fas fa-check-circle"></i></div>
        <div class="stat-value" id="completed-tasks">0</div>
        <div class="stat-label">å·²å®Œæˆä»»åŠ¡</div>
    </div>
</div>

<footer>
    <p>Â© é’æœˆ æ–‡ä»¶æŠ¥é€ç®¡ç†ç³»ç»Ÿ | ä¸“ä¸ºåŠå…¬å®¤èŒå‘˜è®¾è®¡çš„æŠ¥é€ä»»åŠ¡è§£å†³æ–¹æ¡ˆ</p>
    <p style="margin-top: 10px; font-size: 0.9rem;">æŠ€æœ¯æ”¯æŒ: ma5635@163.com | ç‰ˆæœ¬: 2.0.2</p>
</footer>
</div>

<!-- ç¼–è¾‘ä»»åŠ¡æ¨¡æ€æ¡† -->
<div class="modal" id="edit-modal">
<div class="modal-content">
<div class="modal-header">
<h3><i class="fas fa-edit"></i> ç¼–è¾‘æŠ¥é€ä»»åŠ¡</h3>
<div class="close-modal" id="close-modal">Ã—</div>
</div>
<div class="modal-body">
<form id="edit-form">
<input type="hidden" id="edit-id">
            <div class="form-group">
                <label for="edit-task-name"><i class="fas fa-file-alt"></i> æ–‡ä»¶åç§°</label>
                <input type="text" id="edit-task-name" class="form-control" required>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="edit-sender"><i class="fas fa-paper-plane"></i> å‘æ–‡å•ä½</label>
                    <input type="text" id="edit-sender" class="form-control" required>
                </div>

                <div class="form-group">
                    <label for="edit-sender-date"><i class="fas fa-calendar-day"></i> å‘æ–‡æ—¥æœŸ</label>
                    <input type="date" id="edit-sender-date" class="form-control" required>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="edit-receiver"><i class="fas fa-inbox"></i> æ”¶æ–‡å•ä½</label>
                    <input type="text" id="edit-receiver" class="form-control" required>
                </div>

                <div class="form-group">
                    <label for="edit-due-date"><i class="fas fa-calendar-day"></i> æˆªæ­¢æ—¥æœŸ</label>
                    <input type="date" id="edit-due-date" class="form-control" required>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="edit-priority"><i class="fas fa-flag"></i> ä¼˜å…ˆçº§</label>
                    <select id="edit-priority" class="form-control">
                        <option value="high">é«˜ï¼ˆç´§æ€¥ï¼‰</option>
                        <option value="medium">ä¸­ï¼ˆé‡è¦ï¼‰</option>
                        <option value="low">ä½ï¼ˆæ™®é€šï¼‰</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="edit-status"><i class="fas fa-tasks"></i> çŠ¶æ€</label>
                    <select id="edit-status" class="form-control">
                        <option value="pending">å¾…æäº¤</option>
                        <option value="completed">å·²å®Œæˆ</option>
                    </select>
                </div>
            </div>
        </form>
    </div>
    <div class="modal-footer">
        <button class="btn btn-cancel" id="cancel-edit">å–æ¶ˆ</button>
        <button class="btn" id="save-edit">ä¿å­˜ä¿®æ”¹</button>
    </div>
</div>
</div>

<script>
// ä»localStorageåŠ è½½ä»»åŠ¡æ•°æ®
let tasks = JSON.parse(localStorage.getItem('baosong_tasks')) || [
{
id: 1,
name: "å­£åº¦è´¢åŠ¡æŠ¥å‘Š",
sender: "è´¢åŠ¡éƒ¨",
senderDate: "2025-06-01",
receiver: "æ€»ç»ç†åŠå…¬å®¤",
dueDate: "2025-06-15",
priority: "high",
status: "pending"
},
{
id: 2,
name: "å‘˜å·¥ç»©æ•ˆè€ƒæ ¸æ±‡æ€»",
sender: "äººåŠ›èµ„æºéƒ¨",
senderDate: "2025-06-05",
receiver: "å„éƒ¨é—¨ä¸»ç®¡",
dueDate: "2025-06-20",
priority: "medium",
status: "pending"
},
{
id: 3,
name: "é¡¹ç›®è¿›åº¦æœˆæŠ¥",
sender: "é¡¹ç›®éƒ¨",
senderDate: "2025-06-03",
receiver: "é¡¹ç›®ç®¡ç†å§”å‘˜ä¼š",
dueDate: "2025-06-25",
priority: "high",
status: "pending"
},
{
id: 4,
name: "é‡‡è´­å®¡æ‰¹æ–‡ä»¶",
sender: "è¡Œæ”¿éƒ¨",
senderDate: "2025-05-28",
receiver: "è´¢åŠ¡éƒ¨",
dueDate: "2025-06-10",
priority: "low",
status: "completed"
}
];
// ä¿å­˜ä»»åŠ¡æ•°æ®åˆ°localStorage
function saveTasks() {
    localStorage.setItem('baosong_tasks', JSON.stringify(tasks));
}

// å½“å‰ç­›é€‰çŠ¶æ€
let currentFilter = 'all';

// åˆå§‹åŒ–æ—¥å†å’Œä»»åŠ¡
document.addEventListener('DOMContentLoaded', function() {
    const calendarEl = document.getElementById('calendar');
    const currentMonthEl = document.getElementById('current-month');
    const prevMonthBtn = document.getElementById('prev-month');
    const nextMonthBtn = document.getElementById('next-month');
    const todayBtn = document.getElementById('today-btn');
    const taskForm = document.getElementById('task-form');
    const taskListEl = document.getElementById('task-list');
    const downloadBtn = document.getElementById('download-btn');
    const todayEventsEl = document.getElementById('today-events');
    const editModal = document.getElementById('edit-modal');
    const closeModal = document.getElementById('close-modal');
    const cancelEdit = document.getElementById('cancel-edit');
    const saveEdit = document.getElementById('save-edit');
    const filterBtns = document.querySelectorAll('.filter-btn');
    const statCards = document.querySelectorAll('.stat-card');

    let currentDate = new Date();

    // ç”Ÿæˆæ—¥å†
    function generateCalendar() {
        calendarEl.innerHTML = '';

        // æ·»åŠ æ˜ŸæœŸæ ‡é¢˜
        const days = ['å‘¨æ—¥', 'å‘¨ä¸€', 'å‘¨äºŒ', 'å‘¨ä¸‰', 'å‘¨å››', 'å‘¨äº”', 'å‘¨å…­'];
        days.forEach(day => {
            const dayHeader = document.createElement('div');
            dayHeader.className = 'calendar-day-header';
            dayHeader.textContent = day;
            calendarEl.appendChild(dayHeader);
        });

        const year = currentDate.getFullYear();
        const month = currentDate.getMonth();

        currentMonthEl.textContent = `${year}å¹´${month + 1}æœˆ`;

        const firstDay = new Date(year, month, 1);
        const lastDay = new Date(year, month + 1, 0);

        // è·å–æœˆä»½ç¬¬ä¸€å¤©æ˜¯æ˜ŸæœŸå‡ 
        const firstDayOfWeek = firstDay.getDay();

        // è·å–æœˆä»½çš„å¤©æ•°
        const daysInMonth = lastDay.getDate();

        // åœ¨æœˆä»½ç¬¬ä¸€å¤©å‰æ·»åŠ ç©ºç™½å•å…ƒæ ¼
        for (let i = 0; i < firstDayOfWeek; i++) {
            const emptyDay = document.createElement('div');
            emptyDay.className = 'calendar-day empty';
            calendarEl.appendChild(emptyDay);
        }

        // ä¸ºæœˆä»½çš„æ¯ä¸€å¤©æ·»åŠ å•å…ƒæ ¼
        const today = new Date();
        today.setHours(0, 0, 0, 0);

        for (let i = 1; i <= daysInMonth; i++) {
            const day = document.createElement('div');
            day.className = 'calendar-day';

            const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(i).padStart(2, '0')}`;
            const dateObj = new Date(year, month, i);

            // æ ‡è®°ä»Šå¤©
            if (dateObj.getTime() === today.getTime()) {
                day.classList.add('today');
            }

            const dayNumber = document.createElement('div');
            dayNumber.className = 'day-number';
            dayNumber.textContent = i;
            day.appendChild(dayNumber);

            // æ·»åŠ å½“å¤©çš„ä»»åŠ¡
            const dayTasks = tasks.filter(task => task.dueDate === dateStr);
            dayTasks.forEach(task => {
                const event = document.createElement('div');
                event.className = `event ${task.priority === 'high' ? 'urgent' : task.priority === 'medium' ? 'warning' : 'normal'}`;
                event.textContent = task.name;
                event.setAttribute('data-id', task.id);
                day.appendChild(event);
            });

            calendarEl.appendChild(day);
        }

        updateTodayEvents();
        updateTaskList();
        updateStats();
    }

    // æ›´æ–°ä»Šæ—¥ä»»åŠ¡
    function updateTodayEvents() {
        const today = new Date();
        const todayStr = `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`;

        const todayTasks = tasks.filter(task => task.dueDate === todayStr);

        todayEventsEl.innerHTML = '';

        if (todayTasks.length === 0) {
            todayEventsEl.innerHTML = '<div class="event-item" style="justify-content: center; color: #666; padding: 20px;">ä»Šæ—¥æ— æŠ¥é€ä»»åŠ¡</div>';
            return;
        }

        todayTasks.forEach(task => {
            const eventItem = document.createElement('div');
            eventItem.className = 'event-item';

            const priorityClass = task.priority === 'high' ? 'priority-high' : task.priority === 'medium' ? 'priority-medium' : 'priority-low';
            const priorityText = task.priority === 'high' ? 'ç´§æ€¥' : task.priority === 'medium' ? 'é‡è¦' : 'æ™®é€š';

            eventItem.innerHTML = `
                <div class="event-info">
                    <div class="event-name">${task.name}</div>
                    <div class="event-details">
                        <span><i class="fas fa-building"></i> ${task.sender}</span>
                        <span><i class="fas fa-flag"></i> ${priorityText}ä¼˜å…ˆçº§</span>
                    </div>
                </div>
                <div class="task-priority ${priorityClass}">${priorityText}</div>
            `;

            todayEventsEl.appendChild(eventItem);
        });
    }

    // æ›´æ–°ä»»åŠ¡åˆ—è¡¨
    function updateTaskList() {
        taskListEl.innerHTML = '';

        // æ ¹æ®å½“å‰ç­›é€‰æ¡ä»¶è¿‡æ»¤ä»»åŠ¡
        let filteredTasks = tasks;
        if (currentFilter === 'pending') {
            filteredTasks = tasks.filter(task => task.status === 'pending');
        } else if (currentFilter === 'completed') {
            filteredTasks = tasks.filter(task => task.status === 'completed');
        }

        if (filteredTasks.length === 0) {
            taskListEl.innerHTML = '<div style="padding: 20px; text-align: center; color: #666;">æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„ä»»åŠ¡</div>';
            return;
        }

        filteredTasks.forEach(task => {
            const priorityClass = task.priority === 'high' ? 'priority-high' : task.priority === 'medium' ? 'priority-medium' : 'priority-low';
            const priorityText = task.priority === 'high' ? 'é«˜ä¼˜å…ˆçº§' : task.priority === 'medium' ? 'ä¸­ä¼˜å…ˆçº§' : 'ä½ä¼˜å…ˆçº§';
            const statusClass = task.status === 'pending' ? 'status-pending' : 'status-completed';
            const statusText = task.status === 'pending' ? 'å¾…æäº¤' : 'å·²å®Œæˆ';

            const taskItem = document.createElement('div');
            taskItem.className = 'task-item';
            taskItem.innerHTML = `
                <div class="task-header">
                    <div class="task-name">${task.name}</div>
                    <div class="task-priority ${priorityClass}">${priorityText}</div>
                </div>
                <div class="task-details">
                    <div class="task-detail">
                        <i class="fas fa-paper-plane"></i>
                        <span>å‘æ–‡ï¼š${task.sender}</span>
                    </div>
                    <div class="task-detail">
                        <i class="fas fa-calendar-day"></i>
                        <span>å‘æ–‡æ—¥æœŸï¼š${task.senderDate}</span>
                    </div>
                    <div class="task-detail">
                        <i class="fas fa-inbox"></i>
                        <span>æ”¶æ–‡ï¼š${task.receiver}</span>
                    </div>
                    <div class="task-detail">
                        <i class="fas fa-calendar-day"></i>
                        <span>æˆªæ­¢ï¼š${task.dueDate}</span>
                    </div>
                </div>
                <div class="task-footer">
                    <div class="task-status ${statusClass}">${statusText}</div>
                    <div class="task-actions">
                        <div class="action-btn edit-btn" data-id="${task.id}">
                            <i class="fas fa-edit"></i> ç¼–è¾‘
                        </div>
                        <div class="action-btn delete-btn" data-id="${task.id}">
                            <i class="fas fa-trash"></i> åˆ é™¤
                        </div>
                    </div>
                </div>
            `;

            taskListEl.appendChild(taskItem);
        });

        // æ·»åŠ ç¼–è¾‘å’Œåˆ é™¤æŒ‰é’®äº‹ä»¶ç›‘å¬å™¨
        document.querySelectorAll('.edit-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const taskId = parseInt(this.getAttribute('data-id'));
                editTask(taskId);
            });
        });

        document.querySelectorAll('.delete-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const taskId = parseInt(this.getAttribute('data-id'));
                deleteTask(taskId);
            });
        });
    }

    // ç¼–è¾‘ä»»åŠ¡
    function editTask(taskId) {
        const task = tasks.find(t => t.id === taskId);
        if (!task) return;

        // å¡«å……è¡¨å•
        document.getElementById('edit-id').value = task.id;
        document.getElementById('edit-task-name').value = task.name;
        document.getElementById('edit-sender').value = task.sender;
        document.getElementById('edit-sender-date').value = task.senderDate;
        document.getElementById('edit-receiver').value = task.receiver;
        document.getElementById('edit-due-date').value = task.dueDate;
        document.getElementById('edit-priority').value = task.priority;
        document.getElementById('edit-status').value = task.status;

        // æ˜¾ç¤ºæ¨¡æ€æ¡†
        editModal.classList.add('active');
    }

    // ä¿å­˜ç¼–è¾‘
    function saveEditedTask() {
        const taskId = parseInt(document.getElementById('edit-id').value);
        const taskIndex = tasks.findIndex(t => t.id === taskId);

        if (taskIndex === -1) return;

        // æ›´æ–°ä»»åŠ¡æ•°æ®
        tasks[taskIndex] = {
            id: taskId,
            name: document.getElementById('edit-task-name').value,
            sender: document.getElementById('edit-sender').value,
            senderDate: document.getElementById('edit-sender-date').value,
            receiver: document.getElementById('edit-receiver').value,
            dueDate: document.getElementById('edit-due-date').value,
            priority: document.getElementById('edit-priority').value,
            status: document.getElementById('edit-status').value
        };

        // ä¿å­˜åˆ°localStorage
        saveTasks();

        // å…³é—­æ¨¡æ€æ¡†
        editModal.classList.remove('active');

        // æ›´æ–°UI
        updateTaskList();
        generateCalendar();
        updateStats();

        alert('æŠ¥é€ä»»åŠ¡å·²æˆåŠŸæ›´æ–°ï¼');
    }

    // åˆ é™¤ä»»åŠ¡
    function deleteTask(taskId) {
        if (confirm('ç¡®å®šè¦åˆ é™¤æ­¤ä»»åŠ¡å—ï¼Ÿ')) {
            tasks = tasks.filter(task => task.id !== taskId);

            // ä¿å­˜åˆ°localStorage
            saveTasks();

            // æ›´æ–°UI
            updateTaskList();
            generateCalendar();
            updateStats();
        }
    }

    // æ›´æ–°ç»Ÿè®¡æ•°æ®
    function updateStats() {
        const totalTasks = tasks.length;
        const pendingTasks = tasks.filter(task => task.status === 'pending').length;
        const completedTasks = totalTasks - pendingTasks;

        document.getElementById('total-tasks').textContent = totalTasks;
        document.getElementById('pending-tasks').textContent = pendingTasks;
        document.getElementById('completed-tasks').textContent = completedTasks;
    }

    // åˆå§‹åŒ–æ—¥æœŸé€‰æ‹©å™¨ä¸ºä»Šå¤©
    const today = new Date();
    const formattedDate = `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`;
    document.getElementById('due-date').value = formattedDate;
    document.getElementById('sender-date').value = formattedDate;

    // ç”Ÿæˆåˆå§‹æ—¥å†
    generateCalendar();

    // äº‹ä»¶ç›‘å¬å™¨
    prevMonthBtn.addEventListener('click', () => {
        currentDate.setMonth(currentDate.getMonth() - 1);
        generateCalendar();
    });

    nextMonthBtn.addEventListener('click', () => {
        currentDate.setMonth(currentDate.getMonth() + 1);
        generateCalendar();
    });

    todayBtn.addEventListener('click', () => {
        currentDate = new Date();
        generateCalendar();
    });

    taskForm.addEventListener('submit', function(e) {
        e.preventDefault();

        const taskName = document.getElementById('task-name').value;
        const sender = document.getElementById('sender').value;
        const senderDate = document.getElementById('sender-date').value;
        const receiver = document.getElementById('receiver').value;
        const dueDate = document.getElementById('due-date').value;
        const priority = document.getElementById('priority').value;
        const status = document.getElementById('status').value;

        // åˆ›å»ºæ–°ä»»åŠ¡
        const newTask = {
            id: tasks.length > 0 ? Math.max(...tasks.map(task => task.id)) + 1 : 1,
            name: taskName,
            sender: sender,
            senderDate: senderDate,
            receiver: receiver,
            dueDate: dueDate,
            priority: priority,
            status: status
        };

        tasks.push(newTask);

        // ä¿å­˜åˆ°localStorage
        saveTasks();

        // é‡ç½®è¡¨å•
        taskForm.reset();
        document.getElementById('due-date').value = formattedDate;
        document.getElementById('sender-date').value = formattedDate;
        document.getElementById('priority').value = 'medium';
        document.getElementById('status').value = 'pending';

        // æ›´æ–°UI
        generateCalendar();
        updateTaskList();
        updateStats();

        alert('æŠ¥é€ä»»åŠ¡å·²æˆåŠŸæ·»åŠ ï¼');
    });

    // ä¸‹è½½Excel
    downloadBtn.addEventListener('click', function() {
        // åˆ›å»ºExcelå·¥ä½œç°¿
        const wb = XLSX.utils.book_new();

        // å‡†å¤‡æ•°æ®
        const excelData = [
            ['ä»»åŠ¡ID', 'æ–‡ä»¶åç§°', 'å‘æ–‡å•ä½', 'å‘æ–‡æ—¥æœŸ', 'æ”¶æ–‡å•ä½', 'æˆªæ­¢æ—¥æœŸ', 'ä¼˜å…ˆçº§', 'çŠ¶æ€']
        ];

        tasks.forEach(task => {
            const priorityText = task.priority === 'high' ? 'é«˜' : task.priority === 'medium' ? 'ä¸­' : 'ä½';
            const statusText = task.status === 'pending' ? 'å¾…æäº¤' : 'å·²å®Œæˆ';

            excelData.push([
                task.id,
                task.name,
                task.sender,
                task.senderDate,
                task.receiver,
                task.dueDate,
                priorityText,
                statusText
            ]);
        });

        // åˆ›å»ºå·¥ä½œè¡¨
        const ws = XLSX.utils.aoa_to_sheet(excelData);

        // å°†å·¥ä½œè¡¨æ·»åŠ åˆ°å·¥ä½œç°¿
        XLSX.utils.book_append_sheet(wb, ws, 'æŠ¥é€ä»»åŠ¡');

        // ç”ŸæˆExcelæ–‡ä»¶
        const wbout = XLSX.write(wb, {bookType:'xlsx', type:'binary'});

        function s2ab(s) {
            const buf = new ArrayBuffer(s.length);
            const view = new Uint8Array(buf);
            for (let i = 0; i < s.length; i++) view[i] = s.charCodeAt(i) & 0xFF;
            return buf;
        }

        // ä¿å­˜æ–‡ä»¶
        saveAs(new Blob([s2ab(wbout)], {type:"application/octet-stream"}), 
            `æŠ¥é€ä»»åŠ¡_${new Date().toISOString().slice(0,10)}.xlsx`);

        alert('æŠ¥é€ä»»åŠ¡å·²æˆåŠŸå¯¼å‡ºä¸ºExcelæ–‡ä»¶ï¼');
    });

    // ç¼–è¾‘æ¨¡æ€æ¡†äº‹ä»¶
    closeModal.addEventListener('click', () => {
        editModal.classList.remove('active');
    });

    cancelEdit.addEventListener('click', () => {
        editModal.classList.remove('active');
    });

    saveEdit.addEventListener('click', saveEditedTask);

    // ç­›é€‰æŒ‰é’®äº‹ä»¶
    filterBtns.forEach(btn => {
        btn.addEventListener('click', function() {
            const filter = this.getAttribute('data-filter');
            setFilter(filter);
        });
    });

    // ç»Ÿè®¡å¡ç‰‡ç‚¹å‡»äº‹ä»¶
    statCards.forEach(card => {
        card.addEventListener('click', function() {
            const filter = this.getAttribute('data-filter');
            setFilter(filter);
        });
    });

    // è®¾ç½®ç­›é€‰æ¡ä»¶
    function setFilter(filter) {
        currentFilter = filter;

        // æ›´æ–°æŒ‰é’®çŠ¶æ€
        filterBtns.forEach(btn => {
            if (btn.getAttribute('data-filter') === filter) {
                btn.classList.add('active');
            } else {
                btn.classList.remove('active');
            }
        });

        // æ›´æ–°ä»»åŠ¡åˆ—è¡¨
        updateTaskList();
    }
});
</script>
</body>
</html>
