<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="æ¯æ—¥æ—¥æŠ¥ - ä¸€ç«™å¼è·å–ä»Šæ—¥æ–°é—»ã€å¤©æ°”ã€å†å²ã€è¯—è¯ç­‰ä¿¡æ¯">
    <meta name="keywords" content="æ¯æ—¥æ—¥æŠ¥,æ–°é—»,å¤©æ°”,å†å²ä¸Šçš„ä»Šå¤©,è¯—è¯,èŠ‚æ°”,èŠ‚å‡æ—¥">
    <meta name="icon" content="ğŸ“°">
    <meta name="category" content="ä¿¡æ¯å·¥å…·">
    <meta name="features" content="æ–°é—»èµ„è®¯ã€å¤©æ°”ä¿¡æ¯ã€å†å²ä¸Šçš„ä»Šå¤©ã€æ¯æ—¥è¯—è¯ã€èŠ‚æ°”èŠ‚å‡æ—¥ã€æ—¶é—´è¿›åº¦">
    <meta name="show" content="true">
    <title>æ¯æ—¥æ—¥æŠ¥ - ä»Šæ—¥ä¿¡æ¯ä¸€è§ˆ</title>
    
    <!-- CDN èµ„æºé¢„è¿æ¥ -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --bg-color: #f8f9fa;
            --card-bg: #ffffff;
            --text-color: #2c3e50;
            --text-muted: #6c757d;
            --border-color: #dee2e6;
            --shadow: 0 2px 10px rgba(0,0,0,0.1);
            --border-radius: 12px;
        }

        /* ç®€æ´ä¸»é¢˜ */
        body.theme-simple {
            --primary-color: #333333;
            --secondary-color: #666666;
            --accent-color: #999999;
            --success-color: #4a4a4a;
            --warning-color: #666666;
            --bg-color: #ffffff;
            --card-bg: #fafafa;
            --text-color: #333333;
            --text-muted: #666666;
            --border-color: #e0e0e0;
            --shadow: 0 1px 3px rgba(0,0,0,0.05);
            --border-radius: 4px;
        }

        body.theme-simple {
            background: var(--bg-color);
        }

        body.theme-simple .title-section {
            background: var(--card-bg);
            color: var(--text-color);
            border-bottom: 1px solid var(--border-color);
        }

        body.theme-simple .section-header,
        body.theme-simple .sidebar-header {
            background: var(--card-bg);
            color: var(--text-color);
            border-bottom: 1px solid var(--border-color);
        }

        body.theme-simple .news-index {
            background: var(--text-color);
        }

        body.theme-simple .history-year {
            background: var(--text-color);
        }

        body.theme-simple .progress-bar {
            background: var(--text-color);
        }

        body.theme-simple .poetry-content {
            background: var(--card-bg);
        }

        body.theme-simple .fun-content {
            background: var(--card-bg);
        }

        body.theme-simple .carousel-controls {
            background: rgba(0,0,0,0.3);
        }

        body.theme-simple .carousel-controls:hover {
            background: rgba(0,0,0,0.5);
        }

        body.theme-simple .export-btn {
            background: var(--text-color);
        }

        body.theme-simple .export-btn:hover {
            background: var(--secondary-color);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans SC', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: var(--text-color);
            line-height: 1.6;
        }

        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 15px;
        }

        /* ä¸‰æ å¸ƒå±€æ ·å¼ */
        .layout-container {
            display: grid;
            grid-template-columns: 300px 1fr 300px;
            gap: 15px;
            /* min-height: calc(100vh - 80px); */
        }

        .left-sidebar,
        .right-sidebar {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .main-content {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        /* ä¾§æ å¡ç‰‡æ ·å¼ */
        .sidebar-card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            overflow: hidden;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .sidebar-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }

        .sidebar-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 10px 12px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.85rem;
        }

        .sidebar-content {
            padding: 8px;
            font-size: 0.85rem;
        }

        .section-card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            margin-bottom: 8px;
            overflow: hidden;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .section-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }

        .section-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 12px 16px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .section-content {
            padding: 15px;
        }

        /* æ ‡é¢˜åŒºåŸŸæ ·å¼ */
        .title-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-align: center;
            padding: 30px 20px;
            margin-bottom: 10px;
        }

        .main-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .date-info-row {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            gap: 10px;
            font-size: 1.1rem;
            margin-bottom: 15px;
            opacity: 0.9;
        }

        .date-separator {
            color: rgba(255,255,255,0.6);
            font-weight: 300;
        }

        .summary-keywords {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }

        .keyword-tag {
            background: rgba(255,255,255,0.2);
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            backdrop-filter: blur(10px);
        }

        /* æ–°é—»åˆ—è¡¨æ ·å¼ */
        .news-list {
            list-style: none;
        }

        .news-item {
            display: flex;
            align-items: flex-start;
            padding: 15px 0;
            border-bottom: 1px solid var(--border-color);
            transition: background-color 0.3s ease;
        }

        .news-item:hover {
            background-color: var(--bg-color);
            border-radius: 8px;
            margin: 0 -10px;
            padding: 15px 10px;
        }

        .news-item:last-child {
            border-bottom: none;
        }

        .news-index {
            background: var(--secondary-color);
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
            margin-right: 15px;
            flex-shrink: 0;
        }

        .news-content {
            flex: 1;
        }

        .news-title {
            font-weight: 500;
            margin-bottom: 5px;
            color: var(--text-color);
            text-decoration: none;
            display: block;
        }

        .news-title:hover {
            color: var(--secondary-color);
        }

        .news-source {
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        /* å†å²ä¸Šçš„ä»Šå¤©æ ·å¼ */
        .history-list {
            list-style: none;
            padding: 0;
        }

        .history-item {
            padding: 1px 0;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }

        .history-item:last-child {
            border-bottom: none;
        }

        .history-year {
            background: var(--accent-color);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: bold;
            flex-shrink: 0;
        }

        .history-event {
            flex: 1;
            font-size: 0.95rem;
        }

        /* æ¯æ—¥å›¾ç‰‡æ ·å¼ */
        .daily-image {
            text-align: center;
            position: relative;
        }

        /* å›¾ç‰‡è½®æ’­æ ·å¼ */
        .image-carousel {
            position: relative;
            overflow: hidden;
            border-radius: 8px;
            box-shadow: var(--shadow);
        }

        .carousel-container {
            display: flex;
            transition: transform 0.3s ease;
        }

        .carousel-slide {
            min-width: 100%;
            position: relative;
        }

        .carousel-slide img {
            width: 100%;
            height: 300px;
            object-fit: cover;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .carousel-slide img:hover {
            transform: scale(1.02);
        }

        .carousel-controls {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0,0,0,0.5);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.3s ease;
        }

        .carousel-controls:hover {
            background: rgba(0,0,0,0.7);
        }

        .carousel-prev {
            left: 10px;
        }

        .carousel-next {
            right: 10px;
        }

        .carousel-indicators {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 8px;
        }

        .carousel-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: rgba(255,255,255,0.5);
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .carousel-indicator.active {
            background: white;
        }

        .image-caption {
            margin-top: 10px;
            font-style: italic;
            color: var(--text-muted);
        }

        /* å¤§å›¾æŸ¥çœ‹æ¨¡æ€æ¡†æ ·å¼ */
        .image-modal {
            display: none;
            position: fixed;
            z-index: 9999;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.9);
            animation: fadeIn 0.3s ease;
        }

        .image-modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            position: relative;
            max-width: 90%;
            max-height: 90%;
        }

        .modal-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            border-radius: 8px;
        }

        .modal-close {
            position: absolute;
            top: -40px;
            right: 0;
            color: white;
            font-size: 30px;
            cursor: pointer;
            background: none;
            border: none;
            padding: 5px;
        }

        .modal-close:hover {
            color: #ccc;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* è½»æ¾ä¸€åˆ»æ ·å¼ */
        .fun-content {
            background: linear-gradient(135deg, #ffeaa7, #fab1a0);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            font-size: 1.1rem;
            line-height: 1.8;
            color: #2d3436;
        }

        /* æ¯æ—¥è¯—è¯æ ·å¼ */
        .poetry-content {
            background: linear-gradient(135deg, #a8edea, #fed6e3);
            padding: 25px;
            border-radius: 8px;
            text-align: center;
        }

        .poetry-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: #2d3436;
        }

        .poetry-content-text {
            font-size: 1.1rem;
            line-height: 2;
            margin-bottom: 15px;
        }

        .poetry-author {
            font-style: italic;
            color: #74b9ff;
            font-weight: 500;
        }

        /* æ—¶é—´è¿›åº¦ç½‘æ ¼æ ·å¼ */
        .progress-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .progress-item {
            background: var(--bg-color);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        .progress-item h4 {
            font-size: 1rem;
            margin-bottom: 10px;
            color: var(--text-color);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .progress {
            height: 20px;
            border-radius: 10px;
            background-color: var(--bg-color);
            overflow: hidden;
        }

        .progress-bar {
            background: linear-gradient(90deg, var(--success-color), var(--secondary-color));
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 500;
            font-size: 0.85rem;
        }

        .progress-info {
            margin-top: 8px;
            font-size: 0.9rem;
            color: var(--text-muted);
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 5px;
        }

        /* å€’è®¡æ—¶æ ·å¼ */
        .countdown-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 10px;
            text-align: center;
        }

        .countdown-item {
            background: var(--bg-color);
            padding: 15px 10px;
            border-radius: 8px;
        }

        .countdown-number {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--secondary-color);
            display: block;
        }

        .countdown-label {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-top: 5px;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 1200px) {
            .layout-container {
                grid-template-columns: 250px 1fr 250px;
                gap: 15px;
            }
        }

        @media (max-width: 1024px) {
            .layout-container {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .left-sidebar,
            .right-sidebar {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                gap: 15px;
            }

            .main-content {
                order: -1;
            }
        }

        @media (max-width: 768px) {
            .main-container {
                padding: 10px;
            }

            .layout-container {
                gap: 15px;
            }

            .left-sidebar,
            .right-sidebar {
                grid-template-columns: 1fr;
            }

            .date-info-row {
                flex-direction: column;
                gap: 5px;
                text-align: center;
            }

            .date-separator {
                display: none;
            }

            .main-title {
                font-size: 2rem;
            }

            .carousel-slide img {
                height: 200px;
            }
        }

        @media (max-width: 480px) {
            .main-container {
                padding: 5px;
            }

            .section-content,
            .sidebar-content {
                padding: 10px;
            }

            .progress-grid {
                grid-template-columns: 1fr;
            }

            .progress-item {
                padding: 10px;
            }

            .carousel-slide img {
                height: 150px;
            }

            .modal-content {
                max-width: 95%;
                max-height: 95%;
            }
        }

        /* åŠ è½½åŠ¨ç”» */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 40px;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid var(--border-color);
            border-top: 4px solid var(--secondary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* é”™è¯¯æç¤ºæ ·å¼ */
.error-message {
    color: #dc3545;
    text-align: center;
    padding: 20px;
    font-size: 0.9rem;
}

/* å¯¼å‡ºåŠŸèƒ½æ ·å¼ */
.export-section {
    margin-top: 12px;
    text-align: center;
    opacity: 0;
    animation: fadeInUp 0.6s ease-out 0.3s forwards;
}

.export-btn {
    background: linear-gradient(135deg, rgba(108, 117, 125, 0.8), rgba(108, 117, 125, 0.9));
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 8px;
    font-size: 0.8rem;
    cursor: pointer;
    transition: all 0.3s ease;
    display: inline-flex;
    align-items: center;
    gap: 6px;
    backdrop-filter: blur(5px);
    box-shadow: 0 2px 8px rgba(108, 117, 125, 0.2);
    position: relative;
    overflow: hidden;
}

.export-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.5s ease;
}

.export-btn:hover {
    background: linear-gradient(135deg, rgba(90, 98, 104, 0.9), rgba(90, 98, 104, 1));
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(108, 117, 125, 0.3);
}

.export-btn:hover::before {
    left: 100%;
}

.export-btn:active {
    transform: translateY(-1px);
    box-shadow: 0 2px 6px rgba(108, 117, 125, 0.3);
}

/* é¡µè„šæ ·å¼ */
.footer {
    background: linear-gradient(to top, rgba(248, 249, 250, 0.8), rgba(248, 249, 250, 0.3));
    border-top: 1px solid rgba(222, 226, 230, 0.5);
    padding: 12px 0;
    margin-top: 15px;
    font-size: 0.75rem;
    color: rgba(108, 117, 125, 0.8);
    backdrop-filter: blur(10px);
    opacity: 0;
    animation: fadeInUp 0.8s ease-out 0.5s forwards;
    position: relative;
}

.footer::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 1px;
    background: linear-gradient(90deg, transparent, rgba(222, 226, 230, 0.6), transparent);
}

.footer-content {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    transition: all 0.3s ease;
}

.footer-content:hover {
    color: rgba(108, 117, 125, 1);
    transform: translateY(-1px);
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@media (max-width: 768px) {
    .footer-content {
        flex-direction: column;
        gap: 5px;
        text-align: center;
    }
    
    .footer {
        padding: 10px 0;
    }
}
    </style>
</head>
<body>
    <div class="main-container">
        <!-- æ ‡é¢˜ä¿¡æ¯åŒºåŸŸ -->
        <header class="title-section section-card">
            <h1 class="main-title">ğŸ“° æ¯æ—¥ç®€æŠ¥</h1>
            <div class="date-info-row" id="dateInfoRow">
                <span id="currentDate">åŠ è½½ä¸­...</span>
                <span class="date-separator">|</span>
                <span id="lunarYear">åŠ è½½ä¸­...</span>
                <span class="date-separator">|</span>
                <span id="lunarDate">åŠ è½½ä¸­...</span>
                <span class="date-separator">|</span>
                <span id="weekDay">åŠ è½½ä¸­...</span>
                <span class="date-separator">|</span>
                <span id="solarTerm">åŠ è½½ä¸­...</span>
                <span class="date-separator">|</span>
                <span id="holiday">åŠ è½½ä¸­...</span>
                <span class="date-separator">|</span>
                <span id="weatherSummary">åŠ è½½ä¸­...</span>
            </div>
            <div class="summary-keywords" id="summaryKeywords">
                <!-- å…³é”®è¯æ ‡ç­¾å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
            <!-- ä¸»é¢˜åˆ‡æ¢æŒ‰é’® -->
            <div class="theme-toggle" style="margin-top: 15px;">
                <button id="themeToggle" class="btn btn-sm" style="background: rgba(255,255,255,0.2); color: white; border: 1px solid rgba(255,255,255,0.3); padding: 5px 15px; border-radius: 20px; cursor: pointer; transition: all 0.3s ease;">
                    <i class="fas fa-adjust"></i> åˆ‡æ¢ç®€æ´æ¨¡å¼
                </button>
            </div>
        </header>

        <!-- ä¸‰æ å¸ƒå±€å®¹å™¨ -->
        <div class="layout-container">
            <!-- å·¦ä¾§æ  -->
            <aside class="left-sidebar">
                <!-- æ¯æ—¥å›¾ç‰‡ -->
                <div class="sidebar-card">
                    <div class="sidebar-header">
                        <i class="fas fa-image"></i>
                        <span>æ¯æ—¥å›¾ç‰‡</span>
                    </div>
                    <div class="sidebar-content">
                        <div class="daily-image" id="dailyImage">
                            <div class="loading">
                                <div class="spinner"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- è½»æ¾ä¸€åˆ» -->
                <div class="sidebar-card">
                    <div class="sidebar-header">
                        <i class="fas fa-smile"></i>
                        <span>è½»æ¾ä¸€åˆ»</span>
                    </div>
                    <div class="sidebar-content">
                        <div class="fun-content" id="funContent">
                            <div class="loading">
                                <div class="spinner"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- å†å²ä¸Šçš„ä»Šå¤© -->
                <div class="sidebar-card">
                    <div class="sidebar-header">
                        <i class="fas fa-history"></i>
                        <span>å†å²ä¸Šçš„ä»Šå¤© 11.23</span>
                    </div>
                    <div class="sidebar-content">
                        <ul class="history-list" id="historyList">
                            <div class="loading">
                                <div class="spinner"></div>
                            </div>
                        </ul>
                    </div>
                </div>
            </aside>

            <!-- ä¸»å†…å®¹åŒº -->
            <main class="main-content">
                <!-- æ–°é—»èµ„è®¯ -->
                <div class="section-card">
                    <div class="section-header">
                        <i class="fas fa-newspaper"></i>
                        <span>æ–°é—»èµ„è®¯</span>
                        <div class="ms-auto">
                            <select id="newsCount" class="form-select form-select-sm" style="width: auto; display: inline-block;">
                                <option value="5" selected>æ˜¾ç¤º 5 æ¡</option>
                                <option value="10">æ˜¾ç¤º 10 æ¡</option>
                                <option value="15">æ˜¾ç¤º 15 æ¡</option>
                                <option value="20">æ˜¾ç¤º 20 æ¡</option>
                            </select>
                        </div>
                    </div>
                    <div class="section-content">
                        <ul class="news-list" id="newsList">
                            <div class="loading">
                                <div class="spinner"></div>
                            </div>
                        </ul>
                    </div>
                </div>

                <!-- æ—¶é—´è¿›åº¦ -->
                <div class="sidebar-card">
                    <div class="sidebar-header">
                        <i class="fas fa-chart-line"></i>
                        <span>æ—¶é—´è¿›åº¦</span>
                    </div>
                    <div class="sidebar-content">
                        <div class="progress-grid">
                            <div class="progress-item">
                                <h4>ğŸ“… ä»Šæ—¥è¿›åº¦</h4>
                                <div class="progress">
                                    <div class="progress-bar" id="dayProgress" role="progressbar" style="width: 0%">
                                        0%
                                    </div>
                                </div>
                                <div class="progress-info">
                                    <span id="dayProgressInfo">åŠ è½½ä¸­...</span>
                                </div>
                            </div>
                            <div class="progress-item">
                                <h4>ğŸ“† æœ¬å‘¨è¿›åº¦</h4>
                                <div class="progress">
                                    <div class="progress-bar" id="weekProgress" role="progressbar" style="width: 0%">
                                        0%
                                    </div>
                                </div>
                                <div class="progress-info">
                                    <span id="weekProgressInfo">åŠ è½½ä¸­...</span>
                                </div>
                            </div>
                            <div class="progress-item">
                                <h4>ğŸ“Š æœ¬æœˆè¿›åº¦</h4>
                                <div class="progress">
                                    <div class="progress-bar" id="monthProgress" role="progressbar" style="width: 0%">
                                        0%
                                    </div>
                                </div>
                                <div class="progress-info">
                                    <span id="monthProgressInfo">åŠ è½½ä¸­...</span>
                                </div>
                            </div>
                            <div class="progress-item">
                                <h4>ğŸ“ˆ å¹´åº¦è¿›åº¦</h4>
                                <div class="progress">
                                    <div class="progress-bar" id="yearProgress" role="progressbar" style="width: 0%">
                                        0%
                                    </div>
                                </div>
                                <div class="progress-info">
                                    <span id="progressDays">å·²è¿‡å» 0 å¤©</span>
                                    <span id="progressRemaining">è¿˜å‰© 365 å¤©</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                
                <!-- å¯¼å‡ºåŠŸèƒ½åŒºåŸŸ -->
                <div class="export-section">
                    <button id="exportMarkdown" class="export-btn">
                        <i class="fas fa-copy"></i>
                        å¤åˆ¶ä¸º Markdown
                    </button>
                </div>
            </main>

            <!-- å³ä¾§æ  -->
            <aside class="right-sidebar">
                <!-- æ¯æ—¥è¯—è¯ -->
                <div class="sidebar-card">
                    <div class="sidebar-header">
                        <i class="fas fa-feather-alt"></i>
                        <span>æ¯æ—¥è¯—è¯</span>
                    </div>
                    <div class="sidebar-content">
                        <div class="poetry-content" id="poetryContent">
                            <div class="loading">
                                <div class="spinner"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- èŠ‚æ°”ä¿¡æ¯ -->
                <div class="sidebar-card">
                    <div class="sidebar-header">
                        <i class="fas fa-leaf"></i>
                        <span>èŠ‚æ°”ä¿¡æ¯</span>
                    </div>
                    <div class="sidebar-content">
                        <div id="solarTermInfo">
                            <div class="loading">
                                <div class="spinner"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- èŠ‚å‡æ—¥ä¿¡æ¯ -->
                <div class="sidebar-card">
                    <div class="sidebar-header">
                        <i class="fas fa-calendar-alt"></i>
                        <span>èŠ‚å‡æ—¥ä¿¡æ¯</span>
                    </div>
                    <div class="sidebar-content">
                        <div id="holidayCountdown">
                            <div class="loading">
                                <div class="spinner"></div>
                            </div>
                        </div>
                    </div>
                </div>


            </aside>
        </div>

        <!-- å¤§å›¾æŸ¥çœ‹æ¨¡æ€æ¡† -->
        <div class="image-modal" id="imageModal">
            <div class="modal-content">
                <button class="modal-close" id="modalClose">&times;</button>
                <img class="modal-image" id="modalImage" src="" alt="">
            </div>
        </div>

        <!-- é¡µè„š -->
        <footer class="footer">
            <div class="footer-content">
                <span>Â© 2025 æ¯æ—¥æ—¥æŠ¥ | æ•°æ®æ¥æºäºå…¬å¼€API</span>
                <span>æœ€åæ›´æ–°ï¼š<span id="lastUpdate">--</span></span>
            </div>
        </footer>
    </div>

    

    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

    <script>
        // æ¨¡æ‹Ÿæ•°æ®
        const dailyData = {
            weather: {
                location: 'æ­å·',
                temperature: '20Â°C',
                condition: 'å¤šäº‘',
                humidity: '65%',
                windSpeed: 'å¾®é£'
            },
            summary: {
                keywords: ['ç§‘æŠ€åˆ›æ–°', 'å›½é™…å…³ç³»', 'ä½“è‚²ç«æŠ€', 'æ–‡åŒ–å¨±ä¹', 'ç»æµå‘å±•']
            },
            historyToday: [
                { year: '2012', event: 'é›·æ”¿å¯Œä¸é›…è§†é¢‘äº‹ä»¶' },
                { year: '1925', event: 'å›½æ°‘å…šå³æ´¾å¬å¼€è¥¿å±±ä¼šè®®' },
                { year: '1993', event: 'å¤å·´æ”¿åºœå‘æ±Ÿæ³½æ°‘æˆå‹‹' },
                { year: '2008', event: 'å­Ÿä¹°ææ€–è¢­å‡»äº‹ä»¶å‘ç”Ÿ' },
                { year: '1990', event: 'è”åˆå›½å®‰ç†ä¼šæˆæƒå¯¹ä¼Šæ‹‰å…‹åŠ¨æ­¦' }
            ],
            dailyImages: [
                {
                    url: 'https://picsum.photos/500/400',
                    caption: 'ä»Šæ—¥ç¾å›¾ - è“å¤©ç™½äº‘'
                },
                {
                    url: 'https://www.loliapi.com/bg/',
                    caption: 'ä»Šæ—¥ç¾å›¾ - ç»¿æ„ç›ç„¶'
                },
                {
                    url: 'https://api.neix.in/random',
                    caption: 'ä»Šæ—¥ç¾å›¾ - å¤•é˜³è¥¿ä¸‹'
                }
            ],
            funMoment: 'åˆ°äº†æ²¡æœ‰äººè‡ªç”˜å •è½çš„æ—¶å€™ï¼Œäººä¹Ÿå°±ä¸ä¼šå› ä¸ºè¯šå®è€Œå¾—åˆ°èµèª‰äº†ã€‚â€”â€”è¥¿å¡ç½—',
            poetry: {
                title: 'é™å¤œæ€',
                content: 'åºŠå‰æ˜æœˆå…‰ï¼Œç–‘æ˜¯åœ°ä¸Šéœœã€‚</br>ä¸¾å¤´æœ›æ˜æœˆï¼Œä½å¤´æ€æ•…ä¹¡ã€‚',
                author: 'æç™½'
            },
            holidays: [
                { name: 'å…ƒæ—¦', date: '2025-01-01' },
                { name: 'æ˜¥èŠ‚', date: '2025-01-29' },
                { name: 'æ¸…æ˜èŠ‚', date: '2025-04-05' }
            ],
            solarTerms: [
                { name: 'å°é›ª', date: '2024-11-22', description: 'å°é›ªï¼Œæ˜¯äºŒåå››èŠ‚æ°”ä¸­çš„ç¬¬20ä¸ªèŠ‚æ°”ã€‚' },
                { name: 'å¤§é›ª', date: '2024-12-07', description: 'å¤§é›ªï¼Œæ˜¯äºŒåå››èŠ‚æ°”ä¸­çš„ç¬¬21ä¸ªèŠ‚æ°”ã€‚' }
            ]
        };

        // å›¾ç‰‡è½®æ’­ç®¡ç†å™¨
        class ImageCarousel {
            constructor(container, images) {
                this.container = container;
                this.images = images;
                this.currentIndex = 0;
                this.init();
            }

            init() {
                if (this.images.length === 1) {
                    // å•å¼ å›¾ç‰‡
                    this.renderSingleImage();
                } else {
                    // å¤šå¼ å›¾ç‰‡è½®æ’­
                    this.renderCarousel();
                    this.bindEvents();
                    this.startAutoPlay();
                }
            }

            renderSingleImage() {
                const image = this.images[0];
                this.container.innerHTML = `
                    <img src="${image.url}" alt="${image.caption}" onclick="showImageModal('${image.url}')" loading="lazy">
                    <div class="image-caption">${image.caption}</div>
                `;
            }

            renderCarousel() {
                const carouselHtml = `
                    <div class="image-carousel">
                        <div class="carousel-container" id="carouselContainer">
                            ${this.images.map(image => `
                                <div class="carousel-slide">
                                    <img src="${image.url}" alt="${image.caption}" onclick="showImageModal('${image.url}')" loading="lazy">
                                </div>
                            `).join('')}
                        </div>
                        <button class="carousel-controls carousel-prev" onclick="imageCarousel.prev()">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <button class="carousel-controls carousel-next" onclick="imageCarousel.next()">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                        <div class="carousel-indicators">
                            ${this.images.map((_, index) => `
                                <div class="carousel-indicator ${index === 0 ? 'active' : ''}" onclick="imageCarousel.goTo(${index})"></div>
                            `).join('')}
                        </div>
                    </div>
                    <div class="image-caption">${this.images[this.currentIndex].caption}</div>
                `;
                this.container.innerHTML = carouselHtml;
            }

            updateCarousel() {
                const container = document.getElementById('carouselContainer');
                if (container) {
                    container.style.transform = `translateX(-${this.currentIndex * 100}%)`;
                    
                    // æ›´æ–°æŒ‡ç¤ºå™¨
                    document.querySelectorAll('.carousel-indicator').forEach((indicator, index) => {
                        indicator.classList.toggle('active', index === this.currentIndex);
                    });
                    
                    // æ›´æ–°æ ‡é¢˜
                    const caption = this.container.querySelector('.image-caption');
                    if (caption) {
                        caption.textContent = this.images[this.currentIndex].caption;
                    }
                }
            }

            next() {
                this.currentIndex = (this.currentIndex + 1) % this.images.length;
                this.updateCarousel();
            }

            prev() {
                this.currentIndex = (this.currentIndex - 1 + this.images.length) % this.images.length;
                this.updateCarousel();
            }

            goTo(index) {
                this.currentIndex = index;
                this.updateCarousel();
            }

            bindEvents() {
                // é”®ç›˜äº‹ä»¶
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'ArrowLeft') this.prev();
                    if (e.key === 'ArrowRight') this.next();
                });
            }

            startAutoPlay() {
                setInterval(() => {
                    this.next();
                }, 5000); // 5ç§’è‡ªåŠ¨åˆ‡æ¢
            }
        }

        // å…¨å±€å˜é‡
        let imageCarousel;

        // æ˜¾ç¤ºå¤§å›¾æ¨¡æ€æ¡†
        function showImageModal(imageUrl) {
            const modal = document.getElementById('imageModal');
            const modalImage = document.getElementById('modalImage');
            modalImage.src = imageUrl;
            modal.classList.add('show');
        }

        // å…³é—­å¤§å›¾æ¨¡æ€æ¡†
        function closeImageModal() {
            const modal = document.getElementById('imageModal');
            modal.classList.remove('show');
        }

        // å†œå†è®¡ç®—å·¥å…·ç±»
        const LunarCalendar = {
            // å†œå†æ•°æ®æ•°ç»„
            lunarInfo: [
                0x04bd8, 0x04ae0, 0x0a570, 0x054d5, 0x0d260, 0x0d950, 0x16554, 0x056a0, 0x09ad0, 0x055d2,
                0x04ae0, 0x0a5b6, 0x0a4d0, 0x0d250, 0x1d255, 0x0b540, 0x0d6a0, 0x0ada2, 0x095b0, 0x14977,
                0x04970, 0x0a4b0, 0x0b4b5, 0x06a50, 0x06d40, 0x1ab54, 0x02b60, 0x09570, 0x052f2, 0x04970,
                0x06566, 0x0d4a0, 0x0ea50, 0x06e95, 0x05ad0, 0x02b60, 0x186e3, 0x092e0, 0x1c8d7, 0x0c950,
                0x0d4a0, 0x1d8a6, 0x0b550, 0x056a0, 0x1a5b4, 0x025d0, 0x092d0, 0x0d2b2, 0x0a950, 0x0b557,
                0x06ca0, 0x0b550, 0x15355, 0x04da0, 0x0a5b0, 0x14573, 0x052b0, 0x0a9a8, 0x0e950, 0x06aa0,
                0x0aea6, 0x0ab50, 0x04b60, 0x0aae4, 0x0a570, 0x05260, 0x0f263, 0x0d950, 0x05b57, 0x056a0,
                0x096d0, 0x04dd5, 0x04ad0, 0x0a4d0, 0x0d4d4, 0x0d250, 0x0d558, 0x0b540, 0x0b6a0, 0x195a6,
                0x095b0, 0x049b0, 0x0a974, 0x0a4b0, 0x0b27a, 0x06a50, 0x06d40, 0x0af46, 0x0ab60, 0x09570,
                0x04af5, 0x04970, 0x064b0, 0x074a3, 0x0ea50, 0x06b58, 0x055c0, 0x0ab60, 0x096d5, 0x092e0,
                0x0c960, 0x0d954, 0x0d4a0, 0x0da50, 0x07552, 0x056a0, 0x0abb7, 0x025d0, 0x092d0, 0x0cab5,
                0x0a950, 0x0b4a0, 0x0baa4, 0x0ad50, 0x055d9, 0x04ba0, 0x0a5b0, 0x15176, 0x052b0, 0x0a930,
                0x07954, 0x06aa0, 0x0ad50, 0x05b52, 0x04b60, 0x0a6e6, 0x0a4e0, 0x0d260, 0x0ea65, 0x0d530,
                0x05aa0, 0x076a3, 0x096d0, 0x04bd7, 0x04ad0, 0x0a4d0, 0x1d0b6, 0x0d250, 0x0d520, 0x0dd45,
                0x0b5a0, 0x056d0, 0x055b2, 0x049b0, 0x0a577, 0x0a4b0, 0x0aa50, 0x1b255, 0x06d20, 0x0ada0
            ],

            /**
             * è·å–å†œå†å¹´çš„å¤©æ•°
             */
            lYearDays: function(y) {
                let i, sum = 348;
                for (i = 0x8000; i > 0x8; i >>= 1) {
                    sum += (this.lunarInfo[y - 1900] & i) ? 1 : 0;
                }
                return sum + this.leapDays(y);
            },

            /**
             * è·å–å†œå†å¹´é—°æœˆçš„å¤©æ•°
             */
            leapDays: function(y) {
                if (this.leapMonth(y)) {
                    return (this.lunarInfo[y - 1900] & 0x10000) ? 30 : 29;
                }
                return 0;
            },

            /**
             * è·å–å†œå†å¹´é—°å“ªä¸ªæœˆ
             */
            leapMonth: function(y) {
                return this.lunarInfo[y - 1900] & 0xf;
            },

            /**
             * è·å–å†œå†å¹´æœˆçš„å¤©æ•°
             */
            monthDays: function(y, m) {
                return (this.lunarInfo[y - 1900] & (0x10000 >> m)) ? 30 : 29;
            },

            /**
             * å…¬å†è½¬å†œå†
             */
            solar2lunar: function(sYear, sMonth, sDay) {
                const solarDate = new Date(sYear, sMonth - 1, sDay);
                const baseDate = new Date(1900, 0, 31);
                let offset = Math.floor((solarDate - baseDate) / 86400000);

                let i, leap = 0, temp = 0;
                let lYear = 1900;

                for (i = 1900; i < 2050 && offset > 0; i++) {
                    temp = this.lYearDays(i);
                    offset -= temp;
                    lYear++;
                }

                if (offset < 0) {
                    offset += temp;
                    lYear--;
                }

                leap = this.leapMonth(lYear);
                let isLeap = false;

                let lMonth = 1;
                for (i = 1; i < 13 && offset > 0; i++) {
                    if (leap > 0 && i === (leap + 1) && !isLeap) {
                        --i;
                        isLeap = true;
                        temp = this.leapDays(lYear);
                    } else {
                        temp = this.monthDays(lYear, i);
                    }

                    if (isLeap && i === (leap + 1)) isLeap = false;

                    offset -= temp;
                    if (!isLeap) lMonth++;
                }

                if (offset === 0 && leap > 0 && i === leap + 1) {
                    if (isLeap) {
                        isLeap = false;
                    } else {
                        isLeap = true;
                        --lMonth;
                    }
                }

                if (offset < 0) {
                    offset += temp;
                    --lMonth;
                }

                const lDay = offset + 1;

                return {
                    lYear: lYear,
                    lMonth: lMonth,
                    lDay: lDay,
                    isLeap: isLeap
                };
            },

            /**
             * æ ¼å¼åŒ–å†œå†æ—¥æœŸ
             */
            formatLunar: function(lunar) {
                const months = ['æ­£', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­', 'ä¸ƒ', 'å…«', 'ä¹', 'å', 'å†¬', 'è…Š'];
                const days = ['åˆä¸€', 'åˆäºŒ', 'åˆä¸‰', 'åˆå››', 'åˆäº”', 'åˆå…­', 'åˆä¸ƒ', 'åˆå…«', 'åˆä¹', 'åˆå',
                             'åä¸€', 'åäºŒ', 'åä¸‰', 'åå››', 'åäº”', 'åå…­', 'åä¸ƒ', 'åå…«', 'åä¹', 'äºŒå',
                             'å»¿ä¸€', 'å»¿äºŒ', 'å»¿ä¸‰', 'å»¿å››', 'å»¿äº”', 'å»¿å…­', 'å»¿ä¸ƒ', 'å»¿å…«', 'å»¿ä¹', 'ä¸‰å'];

                const monthStr = (lunar.isLeap ? 'é—°' : '') + months[lunar.lMonth - 1] + 'æœˆ';
                const dayStr = days[lunar.lDay - 1];

                return monthStr + dayStr;
            }
        };

        // äºŒåå››èŠ‚æ°”è®¡ç®—å·¥å…·ç±»
        const SolarTerms = {
            terms: [
                'ç«‹æ˜¥', 'é›¨æ°´', 'æƒŠè›°', 'æ˜¥åˆ†', 'æ¸…æ˜', 'è°·é›¨',
                'ç«‹å¤', 'å°æ»¡', 'èŠ’ç§', 'å¤è‡³', 'å°æš‘', 'å¤§æš‘',
                'ç«‹ç§‹', 'å¤„æš‘', 'ç™½éœ²', 'ç§‹åˆ†', 'å¯’éœ²', 'éœœé™',
                'ç«‹å†¬', 'å°é›ª', 'å¤§é›ª', 'å†¬è‡³', 'å°å¯’', 'å¤§å¯’'
            ],

            termInfo: [
                0, 21208, 42467, 63836, 85337, 107014, 128867, 150921, 173149, 195551, 218072, 240693,
                263343, 285989, 308563, 331033, 353350, 375494, 397447, 419210, 440795, 462224, 483532, 504758
            ],

            /**
             * è·å–æŸå¹´æŸèŠ‚æ°”çš„æ—¥æœŸ
             */
            getSolarTermDay: function(year, termIndex) {
                if (year < 1900 || year > 2100) return null;
                if (termIndex < 0 || termIndex > 23) return null;

                const termDay = this.termInfo[termIndex];
                let termDate = Math.floor(termDay / 1000);

                if (year !== 1900) {
                    termDate += Math.floor((year - 1900) * 365.2422 * (this.termInfo[termIndex] % 1000) / 1000);
                }

                const month = Math.floor(termIndex / 2) + 1;
                return new Date(year, month - 1, termDate);
            },

            /**
             * è·å–å½“å‰æ—¥æœŸå¯¹åº”çš„èŠ‚æ°”
             */
            getCurrentTerm: function(date) {
                const year = date.getFullYear();
                const month = date.getMonth() + 1;
                const day = date.getDate();

                for (let i = 0; i < 24; i++) {
                    const termDate = this.getSolarTermDay(year, i);
                    const termMonth = termDate.getMonth() + 1;
                    const termDay = termDate.getDate();

                    if (month === termMonth && day >= termDay) {
                        if (i === 23) {
                            const nextYearFirstTerm = this.getSolarTermDay(year + 1, 0);
                            if (date < nextYearFirstTerm) {
                                return { name: this.terms[i], date: termDate };
                            }
                        } else {
                            const nextTerm = this.getSolarTermDay(year, i + 1);
                            if (date < nextTerm) {
                                return { name: this.terms[i], date: termDate };
                            }
                        }
                    }
                }

                const lastYearWinterSolstice = this.getSolarTermDay(year - 1, 23);
                return { name: this.terms[23], date: lastYearWinterSolstice };
            }
        };

        /**
         * è·å–å†œå†çºªå¹´åç§°ï¼ˆå¤©å¹²åœ°æ”¯ç”Ÿè‚–å¹´ï¼‰
         */
        function getLunarYearName(lunarYear) {
            const heavenlyStems = ['åºš', 'è¾›', 'å£¬', 'ç™¸', 'ç”²', 'ä¹™', 'ä¸™', 'ä¸', 'æˆŠ', 'å·±'];
            const earthlyBranches = ['ç”³', 'é…‰', 'æˆŒ', 'äº¥', 'å­', 'ä¸‘', 'å¯…', 'å¯', 'è¾°', 'å·³', 'åˆ', 'æœª'];
            const zodiacAnimals = ['çŒ´', 'é¸¡', 'ç‹—', 'çŒª', 'é¼ ', 'ç‰›', 'è™', 'å…”', 'é¾™', 'è›‡', 'é©¬', 'ç¾Š'];

            const heavenlyIndex = (lunarYear - 1900) % 10;
            const earthlyIndex = (lunarYear - 1900) % 12;

            const heavenlyStem = heavenlyStems[heavenlyIndex];
            const earthlyBranch = earthlyBranches[earthlyIndex];
            const zodiacAnimal = zodiacAnimals[earthlyIndex];

            return `${heavenlyStem}${earthlyBranch}${zodiacAnimal}`;
        }

        /**
         * åˆå§‹åŒ–æ—¥æœŸä¿¡æ¯
         */
        function initializeDateInfo() {
            const now = new Date();
            const year = now.getFullYear();
            const month = now.getMonth() + 1;
            const day = now.getDate();

            // å…¬å†æ—¥æœŸ
            $('#currentDate').text(`${year}å¹´${month}æœˆ${day}æ—¥`);

            // å†œå†ä¿¡æ¯
            const lunar = LunarCalendar.solar2lunar(year, month, day);
            const lunarYearName = getLunarYearName(lunar.lYear);
            $('#lunarYear').text(`${lunarYearName}å¹´`);
            $('#lunarDate').text(LunarCalendar.formatLunar(lunar));

            // æ˜ŸæœŸ
            const weekDays = ['æ˜ŸæœŸæ—¥', 'æ˜ŸæœŸä¸€', 'æ˜ŸæœŸäºŒ', 'æ˜ŸæœŸä¸‰', 'æ˜ŸæœŸå››', 'æ˜ŸæœŸäº”', 'æ˜ŸæœŸå…­'];
            $('#weekDay').text(weekDays[now.getDay()]);

            // èŠ‚æ°”
            const currentTerm = SolarTerms.getCurrentTerm(now);
            $('#solarTerm').text(currentTerm.name);

            // èŠ‚å‡æ—¥ï¼ˆç®€åŒ–å¤„ç†ï¼‰
            $('#holiday').text('å·¥ä½œæ—¥');

            // å¤©æ°”ä¿¡æ¯
            $('#weatherSummary').text(`${dailyData.weather.location} ${dailyData.weather.temperature} ${dailyData.weather.condition}`);
        }

        /**
         * åˆå§‹åŒ–æ–°é—»åŒºåŸŸ
         */
        function initializeNewsSection() {
            const newsData = [
                { title: 'T1å®˜å®£Gumayusiç¦»é˜Ÿ', source: 'å¾®åšçƒ­æœ', url: '#', hot: '1970123' },
                { title: 'ä¸­å›½å¼ºçƒˆå›åº”éœ‡åŠ¨æ—¥æœ¬', source: 'å¾®åšçƒ­æœ', url: '#', hot: '915779' },
                { title: 'ç¾è¢«æ›ä¼ªé€ è¯æ®é»‘åƒé»‘çªƒå–å·¨é¢æ¯”ç‰¹å¸', source: 'å¾®åšçƒ­æœ', url: '#', hot: '780187' },
                { title: 'T1ç®¡ç†å±‚', source: 'å¾®åšçƒ­æœ', url: '#', hot: '660831' },
                { title: 'é«˜å¸‚æ—©è‹—æäº‹å·²é­åå™¬', source: 'å¾®åšçƒ­æœ', url: '#', hot: '562978' },
                { title: 'Gumayusiå°†ç¦»å¼€T1', source: 'Bç«™çƒ­æœ', url: '#', hot: '' },
                { title: 'å¤–äº¤éƒ¨æ•¦ä¿ƒæ—¥æ–¹åœæ­¢è¶Šçº¿ç©ç«', source: 'Bç«™çƒ­æœ', url: '#', hot: '' },
                { title: 'T1å®˜å®£Doranç»­çº¦', source: 'Bç«™çƒ­æœ', url: '#', hot: '' },
                { title: 'å›½é˜²éƒ¨å›åº”ç¾å¯¹å°3.3äº¿ç¾å…ƒå†›å”®', source: 'Bç«™çƒ­æœ', url: '#', hot: '' },
                { title: 'æ–¹å¤§åŒå‡ºé“20å‘¨å¹´çºªå¿µ', source: 'Bç«™çƒ­æœ', url: '#', hot: '' }
            ];

            renderNewsList(newsData);
        }

        /**
         * æ¸²æŸ“æ–°é—»åˆ—è¡¨
         */
        function renderNewsList(newsData) {
            const count = parseInt($('#newsCount').val()) || 10;
            const limitedNews = newsData.slice(0, count);

            const newsHtml = limitedNews.map((news, index) => `
                <li class="news-item">
                    <div class="news-index">${index + 1}</div>
                    <div class="news-content">
                        <a href="${news.url}" target="_blank" class="news-title">
                            ${news.title}
                        </a>
                        <div class="news-source">
                            æ¥æºï¼š${news.source} ${news.hot ? `| çƒ­åº¦ï¼š${news.hot}` : ''}
                        </div>
                    </div>
                </li>
            `).join('');

            $('#newsList').html(newsHtml);
        }

        /**
         * åˆå§‹åŒ–å†å²ä¸Šçš„ä»Šå¤©
         */
        function initializeHistorySection() {
            const historyHtml = dailyData.historyToday.slice(0, 5).map(item => `
                <li class="history-item">
                    <div class="history-year">${item.year}</div>
                    <div class="history-event">${item.event}</div>
                </li>
            `).join('');

            $('#historyList').html(historyHtml);
        }

        /**
         * åˆå§‹åŒ–æ¯æ—¥å›¾ç‰‡
         */
        function initializeDailyImage() {
            const container = document.getElementById('dailyImage');
            imageCarousel = new ImageCarousel(container, dailyData.dailyImages);
        }

        /**
         * åˆå§‹åŒ–è½»æ¾ä¸€åˆ»
         */
        function initializeFunContent() {
            $('#funContent').html(dailyData.funMoment);
        }

        /**
         * åˆå§‹åŒ–æ¯æ—¥è¯—è¯
         */
        function initializePoetryContent() {
            const poetryHtml = `
                <div class="poetry-title">${dailyData.poetry.title}</div>
                <div class="poetry-content-text">${dailyData.poetry.content}</div>
                <div class="poetry-author">â€”â€” ${dailyData.poetry.author}</div>
            `;

            $('#poetryContent').html(poetryHtml);
        }

        /**
         * åˆå§‹åŒ–èŠ‚å‡æ—¥å€’è®¡æ—¶
         */
        function initializeHolidayCountdown() {
            const nextHoliday = getNextHoliday(dailyData.holidays);
            if (nextHoliday) {
                const countdown = calculateCountdown(nextHoliday.date);
                const countdownHtml = `
                    <h5>è·ç¦» ${nextHoliday.name} è¿˜æœ‰ï¼š</h5>
                    <div class="countdown-container">
                        <div class="countdown-item">
                            <span class="countdown-number">${countdown.days}</span>
                            <div class="countdown-label">å¤©</div>
                        </div>
                        <div class="countdown-item">
                            <span class="countdown-number">${countdown.hours}</span>
                            <div class="countdown-label">æ—¶</div>
                        </div>
                        <div class="countdown-item">
                            <span class="countdown-number">${countdown.minutes}</span>
                            <div class="countdown-label">åˆ†</div>
                        </div>
                        <div class="countdown-item">
                            <span class="countdown-number">${countdown.seconds}</span>
                            <div class="countdown-label">ç§’</div>
                        </div>
                    </div>
                `;
                $('#holidayCountdown').html(countdownHtml);
            } else {
                $('#holidayCountdown').html('<div class="text-center">æš‚æ— å³å°†åˆ°æ¥çš„èŠ‚å‡æ—¥</div>');
            }
        }

        /**
         * åˆå§‹åŒ–èŠ‚æ°”ä¿¡æ¯
         */
        function initializeSolarTermInfo() {
            const currentTerm = getCurrentSolarTermInfo(dailyData.solarTerms);
            const nextTerm = getNextSolarTerm(dailyData.solarTerms);

            let termHtml = '';
            if (currentTerm) {
                termHtml += `
                    <div class="mb-3">
                        <h5>å½“å‰èŠ‚æ°”ï¼š${currentTerm.name}</h5>
                        <p>${currentTerm.description}</p>
                    </div>
                `;
            }

            if (nextTerm) {
                const countdown = calculateCountdown(nextTerm.date);
                termHtml += `
                    <div>
                        <h5>ä¸‹ä¸ªèŠ‚æ°”ï¼š${nextTerm.name}</h5>
                        <div class="countdown-container">
                            <div class="countdown-item">
                                <span class="countdown-number">${countdown.days}</span>
                                <div class="countdown-label">å¤©</div>
                            </div>
                            <div class="countdown-item">
                                <span class="countdown-number">${countdown.hours}</span>
                                <div class="countdown-label">æ—¶</div>
                            </div>
                        </div>
                    </div>
                `;
            }

            $('#solarTermInfo').html(termHtml);
        }

        /**
         * åˆå§‹åŒ–å¹´åº¦æ—¶é—´è¿›åº¦
         */
        function initializeYearProgress() {
            const now = new Date();

            // è®¡ç®—å½“å¤©è¿›åº¦
            const dayProgress = calculateDayProgress(now);
            updateProgressBar('dayProgress', dayProgress.percentage);
            $('#dayProgressInfo').text(`${dayProgress.info}`);

            // è®¡ç®—æœ¬å‘¨è¿›åº¦
            const weekProgress = calculateWeekProgress(now);
            updateProgressBar('weekProgress', weekProgress.percentage);
            $('#weekProgressInfo').text(`${weekProgress.info}`);

            // è®¡ç®—æœ¬æœˆè¿›åº¦
            const monthProgress = calculateMonthProgress(now);
            updateProgressBar('monthProgress', monthProgress.percentage);
            $('#monthProgressInfo').text(`${monthProgress.info}`);

            // è®¡ç®—å¹´åº¦è¿›åº¦
            const yearProgress = calculateYearProgress(now);
            updateProgressBar('yearProgress', yearProgress.percentage);
            $('#progressDays').text(`å·²è¿‡å» ${yearProgress.passedDays} å¤©`);
            $('#progressRemaining').text(`è¿˜å‰© ${yearProgress.remainingDays} å¤©`);
        }

        /**
         * è®¡ç®—å½“å¤©è¿›åº¦
         */
        function calculateDayProgress(now) {
            const hours = now.getHours();
            const minutes = now.getMinutes();
            const totalMinutes = hours * 60 + minutes;
            const percentage = Math.round((totalMinutes / (24 * 60)) * 100);

            return {
                percentage: percentage,
                info: `${hours}:${minutes.toString().padStart(2, '0')} (${percentage}%)`
            };
        }

        /**
         * è®¡ç®—æœ¬å‘¨è¿›åº¦
         */
        function calculateWeekProgress(now) {
            const dayOfWeek = now.getDay();
            const hours = now.getHours();
            const minutes = now.getMinutes();

            const mondayBasedDay = dayOfWeek === 0 ? 6 : dayOfWeek - 1;
            const totalMinutes = mondayBasedDay * 24 * 60 + hours * 60 + minutes;
            const weekTotalMinutes = 7 * 24 * 60;
            const percentage = Math.round((totalMinutes / weekTotalMinutes) * 100);

            const weekDays = ['å‘¨æ—¥', 'å‘¨ä¸€', 'å‘¨äºŒ', 'å‘¨ä¸‰', 'å‘¨å››', 'å‘¨äº”', 'å‘¨å…­'];
            return {
                percentage: percentage,
                info: `${weekDays[dayOfWeek]} (${percentage}%)`
            };
        }

        /**
         * è®¡ç®—æœ¬æœˆè¿›åº¦
         */
        function calculateMonthProgress(now) {
            const year = now.getFullYear();
            const month = now.getMonth();
            const date = now.getDate();
            const hours = now.getHours();
            const minutes = now.getMinutes();

            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const totalMinutes = (date - 1) * 24 * 60 + hours * 60 + minutes;
            const monthTotalMinutes = daysInMonth * 24 * 60;
            const percentage = Math.round((totalMinutes / monthTotalMinutes) * 100);

            return {
                percentage: percentage,
                info: `${date}/${daysInMonth}æ—¥ (${percentage}%)`
            };
        }

        /**
         * è®¡ç®—å¹´åº¦è¿›åº¦
         */
        function calculateYearProgress(now) {
            const year = now.getFullYear();
            const startOfYear = new Date(year, 0, 1);
            const endOfYear = new Date(year + 1, 0, 1);

            const totalDays = Math.floor((endOfYear - startOfYear) / (1000 * 60 * 60 * 24));
            const passedDays = Math.floor((now - startOfYear) / (1000 * 60 * 60 * 24));
            const remainingDays = totalDays - passedDays;
            const percentage = Math.round((passedDays / totalDays) * 100);

            return {
                percentage: percentage,
                passedDays: passedDays,
                remainingDays: remainingDays
            };
        }

        /**
         * æ›´æ–°è¿›åº¦æ¡
         */
        function updateProgressBar(elementId, percentage) {
            $(`#${elementId}`).css('width', percentage + '%').text(percentage + '%');
        }

        /**
         * è·å–ä¸‹ä¸€ä¸ªèŠ‚å‡æ—¥
         */
        function getNextHoliday(holidays) {
            const now = new Date();
            const futureHolidays = holidays.filter(holiday => new Date(holiday.date) > now);
            futureHolidays.sort((a, b) => new Date(a.date) - new Date(b.date));
            return futureHolidays[0];
        }

        /**
         * è·å–å½“å‰èŠ‚æ°”ä¿¡æ¯
         */
        function getCurrentSolarTermInfo(solarTerms) {
            return solarTerms[0];
        }

        /**
         * è·å–ä¸‹ä¸€ä¸ªèŠ‚æ°”
         */
        function getNextSolarTerm(solarTerms) {
            const now = new Date();
            const futureSolarTerms = solarTerms.filter(term => new Date(term.date) > now);
            futureSolarTerms.sort((a, b) => new Date(a.date) - new Date(b.date));
            return futureSolarTerms[0];
        }

        /**
         * è®¡ç®—å€’è®¡æ—¶
         */
        function calculateCountdown(targetDate) {
            const now = new Date();
            const target = new Date(targetDate);
            const diff = target - now;

            if (diff <= 0) {
                return { days: 0, hours: 0, minutes: 0, seconds: 0 };
            }

            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((diff % (1000 * 60)) / 1000);

            return { days, hours, minutes, seconds };
        }

        /**
         * ç»‘å®šäº‹ä»¶
         */
        function bindEvents() {
            // æ–°é—»æ•°é‡é€‰æ‹©å˜åŒ–äº‹ä»¶
            $('#newsCount').on('change', function() {
                initializeNewsSection();
            });

            // æ¨¡æ€æ¡†å…³é—­äº‹ä»¶
            $('#modalClose').on('click', closeImageModal);
            $('#imageModal').on('click', function(e) {
                if (e.target === this) {
                    closeImageModal();
                }
            });

            // ESCé”®å…³é—­æ¨¡æ€æ¡†
            $(document).on('keydown', function(e) {
                if (e.key === 'Escape') {
                    closeImageModal();
                }
            });

            // ä¸»é¢˜åˆ‡æ¢äº‹ä»¶
            $('#themeToggle').on('click', function() {
                toggleTheme();
            });

            // å®šæ—¶æ›´æ–°å€’è®¡æ—¶
            setInterval(() => {
                initializeHolidayCountdown();
                initializeSolarTermInfo();
                initializeYearProgress();
            }, 1000);
        }

        /**
         * åˆ‡æ¢ä¸»é¢˜
         */
        function toggleTheme() {
            const body = document.body;
            const themeToggle = document.getElementById('themeToggle');
            
            if (body.classList.contains('theme-simple')) {
                // åˆ‡æ¢å›é»˜è®¤ä¸»é¢˜
                body.classList.remove('theme-simple');
                themeToggle.innerHTML = '<i class="fas fa-adjust"></i> åˆ‡æ¢ç®€æ´æ¨¡å¼';
                localStorage.setItem('theme', 'default');
            } else {
                // åˆ‡æ¢åˆ°ç®€æ´ä¸»é¢˜
                body.classList.add('theme-simple');
                themeToggle.innerHTML = '<i class="fas fa-adjust"></i> åˆ‡æ¢é»˜è®¤æ¨¡å¼';
                localStorage.setItem('theme', 'simple');
            }
        }

        /**
         * åˆå§‹åŒ–ä¸»é¢˜
         */
        function initializeTheme() {
            const savedTheme = localStorage.getItem('theme');
            const themeToggle = document.getElementById('themeToggle');
            
            if (savedTheme === 'simple') {
                document.body.classList.add('theme-simple');
                themeToggle.innerHTML = '<i class="fas fa-adjust"></i> åˆ‡æ¢é»˜è®¤æ¨¡å¼';
            }
        }

        /**
         * é¡µé¢åˆå§‹åŒ–
         */
        $(document).ready(function() {
            try {
                initializeTheme();
                initializeDateInfo();
                initializeNewsSection();
                initializeHistorySection();
                initializeDailyImage();
                initializeFunContent();
                initializePoetryContent();
                initializeHolidayCountdown();
                initializeSolarTermInfo();
                initializeYearProgress();
                bindEvents();
                
                // ç»‘å®šå¯¼å‡ºæŒ‰é’®äº‹ä»¶
                document.getElementById('exportMarkdown').addEventListener('click', exportToMarkdown);
                
                // æ›´æ–°æœ€åæ›´æ–°æ—¶é—´
                document.getElementById('lastUpdate').textContent = new Date().toLocaleString('zh-CN');
            } catch (error) {
                console.error('é¡µé¢åˆå§‹åŒ–å¤±è´¥:', error);
            }
        });

        // å¯¼å‡ºä¸ºMarkdownåŠŸèƒ½
        function exportToMarkdown() {
            try {
                let markdown = '';
                const now = new Date();
                const dateStr = now.toLocaleDateString('zh-CN');
                
                // æ ‡é¢˜
                markdown += `# æ¯æ—¥æ—¥æŠ¥ - ${dateStr}\n\n`;
                
                // æ—¥æœŸä¿¡æ¯
                const dateInfo = document.querySelector('.date-info-row');
                if (dateInfo) {
                    markdown += `### ğŸ“… æ—¥æœŸä¿¡æ¯\n\n`;
                    const dateItems = dateInfo.querySelectorAll('.date-item, span');
                    const dateTexts = [];
                    dateItems.forEach(item => {
                        const text = item.textContent.trim();
                        if (text && !text.includes('|') && text !== 'Â·') {
                            dateTexts.push(text);
                        }
                    });
                    if (dateTexts.length > 0) {
                        markdown += `${dateTexts.join(' Â· ')}\n\n`;
                    }
                }

                // å¤©æ°”ä¿¡æ¯
                const weatherInfo = document.querySelector('.weather-summary');
                if (weatherInfo && weatherInfo.textContent.trim()) {
                    markdown += `### ğŸŒ¤ï¸ å¤©æ°”ä¿¡æ¯\n\n`;
                    markdown += `${weatherInfo.textContent.trim()}\n\n`;
                }

                // å†å²ä¸Šçš„ä»Šå¤©
                const historyContent = document.getElementById('historyContent');
                if (historyContent && !historyContent.querySelector('.loading')) {
                    markdown += `### ğŸ“š å†å²ä¸Šçš„ä»Šå¤©\n\n`;
                    const historyItems = historyContent.querySelectorAll('.history-item');
                    historyItems.forEach(item => {
                        const year = item.querySelector('.history-year')?.textContent || '';
                        const event = item.querySelector('.history-event')?.textContent || '';
                        if (year && event) {
                            markdown += `- **${year}** ${event}\n`;
                        }
                    });
                    markdown += '\n';
                }

                // è½»æ¾ä¸€åˆ»
                const funContent = document.getElementById('funContent');
                if (funContent && !funContent.querySelector('.loading')) {
                    markdown += `### ğŸ˜„ è½»æ¾ä¸€åˆ»\n\n`;
                    const funText = funContent.textContent.trim();
                    if (funText) {
                        markdown += `${funText}\n\n`;
                    }
                }

                // æ¯æ—¥å›¾ç‰‡
                const dailyImage = document.getElementById('dailyImage');
                if (dailyImage && !dailyImage.querySelector('.loading')) {
                    markdown += `### ğŸ–¼ï¸ æ¯æ—¥å›¾ç‰‡\n\n`;
                    const images = dailyImage.querySelectorAll('img');
                    images.forEach((img, index) => {
                        if (img.src && img.alt) {
                            markdown += `![${img.alt}](${img.src})\n`;
                        }
                    });
                    markdown += '\n';
                }

                // æ¯æ—¥è¯—è¯
                const poetryContent = document.getElementById('poetryContent');
                if (poetryContent && !poetryContent.querySelector('.loading')) {
                    markdown += `### ğŸ“ æ¯æ—¥è¯—è¯\n\n`;
                    const poetryText = poetryContent.textContent.trim();
                    if (poetryText) {
                        markdown += `> ${poetryText}\n\n`;
                    }
                }

                // èŠ‚å‡æ—¥ä¿¡æ¯
                const holidayInfo = document.getElementById('holidayInfo');
                if (holidayInfo && !holidayInfo.querySelector('.loading')) {
                    markdown += `### ğŸ‰ èŠ‚å‡æ—¥ä¿¡æ¯\n\n`;
                    const holidayText = holidayInfo.textContent.trim();
                    if (holidayText && holidayText !== 'ä»Šæ—¥æ— ç‰¹æ®ŠèŠ‚å‡æ—¥') {
                        markdown += `${holidayText}\n\n`;
                    }
                }

                // èŠ‚æ°”ä¿¡æ¯
                const solarTermInfo = document.getElementById('solarTermInfo');
                if (solarTermInfo && !solarTermInfo.querySelector('.loading')) {
                    markdown += `### ğŸŒ¿ èŠ‚æ°”ä¿¡æ¯\n\n`;
                    const termText = solarTermInfo.textContent.trim();
                    if (termText) {
                        markdown += `${termText}\n\n`;
                    }
                }

                // æ—¶é—´è¿›åº¦
                const progressItems = document.querySelectorAll('.progress-item');
                if (progressItems.length > 0) {
                    markdown += `### ğŸ“Š æ—¶é—´è¿›åº¦\n\n`;
                    progressItems.forEach(item => {
                        const title = item.querySelector('h4')?.textContent || '';
                        const progressBar = item.querySelector('.progress-bar');
                        const progressInfo = item.querySelector('.progress-info')?.textContent || '';
                        
                        if (title && progressBar) {
                            const percentage = progressBar.style.width || progressBar.textContent || '0%';
                            markdown += `- **${title}**: ${percentage}`;
                            if (progressInfo) {
                                markdown += ` (${progressInfo})`;
                            }
                            markdown += '\n';
                        }
                    });
                    markdown += '\n';
                }

                // æ–°é—»èµ„è®¯
                const newsList = document.getElementById('newsList');
                if (newsList && !newsList.querySelector('.loading')) {
                    markdown += `### ğŸ“° æ–°é—»èµ„è®¯\n\n`;
                    
                    const newsItems = newsList.querySelectorAll('.news-item');
                    newsItems.forEach((item, index) => {
                        const title = item.querySelector('.news-title')?.textContent || '';
                        const source = item.querySelector('.news-source')?.textContent || '';
                        if (title) {
                            markdown += `${index + 1}. **${title}**`;
                            if (source) {
                                markdown += ` - ${source}`;
                            }
                            markdown += '\n';
                        }
                    });
                    markdown += '\n';
                }

                // é¡µè„šä¿¡æ¯
                markdown += `---\n\n`;
                markdown += `*ç”Ÿæˆæ—¶é—´ï¼š${now.toLocaleString('zh-CN')}*\n`;
                markdown += `*æ•°æ®æ¥æºï¼šå…¬å¼€API*\n`;

                // å¤åˆ¶åˆ°å‰ªè´´æ¿
                navigator.clipboard.writeText(markdown).then(() => {
                    // æ˜¾ç¤ºæˆåŠŸæç¤º
                    const btn = document.getElementById('exportMarkdown');
                    const originalText = btn.innerHTML;
                    btn.innerHTML = '<i class="fas fa-check"></i> å·²å¤åˆ¶';
                    btn.style.background = '#28a745';
                    
                    setTimeout(() => {
                        btn.innerHTML = originalText;
                        btn.style.background = '#6c757d';
                    }, 2000);
                }).catch(err => {
                    console.error('å¤åˆ¶å¤±è´¥:', err);
                    alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶å†…å®¹');
                });

            } catch (error) {
                console.error('å¯¼å‡ºMarkdownå¤±è´¥:', error);
                alert('å¯¼å‡ºå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
            }
        }
    </script>
</body>
</html>
